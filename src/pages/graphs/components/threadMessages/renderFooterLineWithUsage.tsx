import React from 'react';

import type { ThreadMessageDtoRequestTokenUsage } from '../../../../autogenerated';
import { formatDurationMs } from './threadMessagesViewUtils';
import { TokenUsagePopoverIcon } from './TokenUsagePopoverIcon';

export const renderFooterLineWithUsage = (
  text: string,
  requestTokenUsage?: ThreadMessageDtoRequestTokenUsage | null,
  requestTokenUsageIn?: ThreadMessageDtoRequestTokenUsage | null,
  requestTokenUsageOut?: ThreadMessageDtoRequestTokenUsage | null,
  durationMs?: number,
): React.ReactNode => {
  const showDuration = typeof durationMs === 'number' && durationMs > 0;

  return (
    <span style={{ display: 'inline-flex', alignItems: 'center', gap: 6 }}>
      <span>{text}</span>
      {showDuration && (
        <span style={{ color: '#8c8c8c' }}>{formatDurationMs(durationMs)}</span>
      )}
      <TokenUsagePopoverIcon
        requestTokenUsage={requestTokenUsage}
        requestTokenUsageIn={requestTokenUsageIn}
        requestTokenUsageOut={requestTokenUsageOut}
        durationMs={durationMs}
      />
    </span>
  );
};
