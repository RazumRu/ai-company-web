import { Card, Typography, Space, Tag, Empty } from 'antd';
import type { TemplateDto } from '../../../autogenerated';

const { Title, Text } = Typography;

interface TemplateSidebarProps {
  onTemplateClick: (template: TemplateDto) => void;
  templates: TemplateDto[];
}

export const TemplateSidebar = ({ onTemplateClick, templates }: TemplateSidebarProps) => {

  const onDragStart = (event: React.DragEvent, template: TemplateDto) => {
    event.dataTransfer.setData(
      'application/reactflow',
      JSON.stringify(template),
    );
    event.dataTransfer.effectAllowed = 'move';
  };

  if (templates.length === 0) {
    return (
      <div style={{ padding: 24 }}>
        <Empty description="No templates available" />
      </div>
    );
  }

  return (
    <div style={{ padding: 16, height: '100%', overflowY: 'auto' }}>
      <Title level={4} style={{ marginBottom: 16 }}>
        Templates
      </Title>
      <Space direction="vertical" style={{ width: '100%' }} size="middle">
        {templates.map((template) => (
          <Card
            key={template.name}
            size="small"
            hoverable
            draggable
            onDragStart={(e) => onDragStart(e, template)}
            onClick={() => onTemplateClick(template)}
            style={{ cursor: 'grab' }}
            styles={{ body: { padding: 12 } }}>
            <Space direction="vertical" size="small" style={{ width: '100%' }}>
              <Text strong>{template.name}</Text>
              <Tag color="blue">{template.kind}</Tag>
              <Text type="secondary" style={{ fontSize: 12 }}>
                {template.description}
              </Text>
            </Space>
          </Card>
        ))}
      </Space>
    </div>
  );
};
